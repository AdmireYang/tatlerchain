import{aa as u,I as C,r as l,c as I}from"./index-B14LQPlx.js";function $(a){return u.get("/backstage/posts",{params:a})}function A(a){return u.get(`/backstage/posts/${a}`)}function E(a){return u.post("/backstage/posts",a)}function B(a,c){return u.put(`/backstage/posts/${a}`,c)}function F(a){return u.delete(`/backstage/posts/${a}`)}function G(a){return u.patch(`/backstage/posts/${a}/publish`)}const O=C("post",()=>{const a=l([]),c=l(null),v=l(0),o=l(!1),r=l({search:"",status:void 0,category:void 0}),n=l(1),f=l(10),y=I(()=>a.value.length<v.value);async function i(e){o.value=!0;try{const t={page:(e==null?void 0:e.page)??n.value,pageSize:(e==null?void 0:e.pageSize)??f.value,search:(e==null?void 0:e.search)??r.value.search,status:(e==null?void 0:e.status)??r.value.status,category:(e==null?void 0:e.category)??r.value.category},s=await $(t);a.value=s.data.data.data,v.value=s.data.data.meta.total,n.value=s.data.data.meta.page,f.value=s.data.data.meta.pageSize}catch(t){throw console.error("获取推文列表失败:",t),t}finally{o.value=!1}}async function d(e){o.value=!0;try{const t=await A(e);return c.value=t.data.data,t.data.data}catch(t){throw console.error("获取推文详情失败:",t),t}finally{o.value=!1}}async function g(e){o.value=!0;try{const t=await E(e);return await i(),t.data.data}catch(t){throw console.error("创建推文失败:",t),t}finally{o.value=!1}}async function h(e,t){o.value=!0;try{const s=await B(e,t);return await i(),s.data.data}catch(s){throw console.error("更新推文失败:",s),s}finally{o.value=!1}}async function w(e){o.value=!0;try{await F(e),await i()}catch(t){throw console.error("删除推文失败:",t),t}finally{o.value=!1}}async function P(e){o.value=!0;try{const t=await G(e);return await i(),t.data.data}catch(t){throw console.error("发布推文失败:",t),t}finally{o.value=!1}}function b(e){r.value={...r.value,...e}}function p(){r.value={search:"",status:void 0,category:void 0},n.value=1}function k(e){n.value=e}function S(e){f.value=e,n.value=1}function z(){c.value=null}return{posts:a,currentPost:c,total:v,loading:o,filters:r,page:n,pageSize:f,hasMore:y,fetchPosts:i,fetchPostById:d,create:g,update:h,remove:w,publish:P,setFilters:b,resetFilters:p,setPage:k,setPageSize:S,clearCurrentPost:z}}),R=[{key:"museum",label:"博物"},{key:"profile",label:"人物"},{key:"opera",label:"评弹"},{key:"gallery",label:"影集"},{key:"special",label:"刊中刊"}],T={museum:"博物",profile:"人物",opera:"评弹",gallery:"影集",special:"刊中刊"};export{T as C,R as a,$ as g,O as u};

import{v as A,aB as F,j as U,ab as i,B as r,z as s,E as a,C as n,D as l,Q as c,u as o,y as u,O as _,J as j,a5 as H,R as g,k as P}from"./vue-vendor-C3C-az8a.js";import{n as M,p as J,E as f}from"./element-plus-B8SKDpVE.js";import"./index-DNHOLSe2.js";import{u as O,g as Q}from"./post-BhA1O24y.js";import{u as q,L as G,s as K,a as W}from"./ListSkeleton-_MKWwpuj.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"posts-page"},Z={class:"page-header"},ee={key:1},te={key:2,class:"post-list"},se={class:"post-image-wrapper"},oe={class:"image-error"},ae={class:"post-content"},ne={class:"post-header"},le=["title"],ie={class:"post-meta"},re={class:"post-category"},ce={class:"post-views"},de={key:0,class:"post-excerpt"},ue={class:"post-actions"},pe={key:3,class:"pagination-wrapper"},me=A({__name:"Posts",setup(_e){const E=F(),k=O(),{data:v,total:x,loading:S,page:y,pageSize:p,fetchData:C,handlePageChange:B,handlePageSizeChange:D}=q(Q);function I(){E.push("/posts/create")}function b(d){E.push(`/posts/edit/${d}`)}async function R(d){if(await K("这篇推文"))try{await k.publish(d),f.success("发布成功"),C()}catch{f.error("发布失败")}}async function T(d){if(await W("这篇推文"))try{await k.remove(d),f.success("删除成功"),C()}catch{f.error("删除失败")}}return U(()=>{C()}),(d,e)=>{const z=i("ElIcon"),m=i("ElButton"),V=i("ElEmpty"),L=i("ElImage"),h=i("ElTag"),N=i("ElPagination"),$=i("ElCard");return s(),r("div",Y,[a("div",Z,[e[3]||(e[3]=a("h1",{class:"text-2xl font-bold"},"推文管理",-1)),n(m,{type:"primary",onClick:I},{default:l(()=>[n(z,null,{default:l(()=>[n(o(M))]),_:1}),e[2]||(e[2]=c(" 新建推文 ",-1))]),_:1})]),n($,{class:"list-card",shadow:"never"},{default:l(()=>[o(S)?(s(),u(G,{key:0,count:o(p)},null,8,["count"])):o(v).length===0?(s(),r("div",ee,[n(V,{description:"暂无推文数据"})])):(s(),r("div",te,[(s(!0),r(j,null,H(o(v),t=>(s(),r("div",{key:t.id,class:"post-card"},[a("div",se,[n(L,{src:t.coverImage,fit:"cover",class:"post-image"},{error:l(()=>[a("div",oe,[n(z,null,{default:l(()=>[n(o(J))]),_:1})])]),_:1},8,["src"])]),a("div",ae,[a("div",ne,[a("div",{class:"post-title",title:t.title},g(t.title),9,le),a("div",ie,[t.status==="DRAFT"?(s(),u(h,{key:0,type:"info",size:"small"},{default:l(()=>[...e[4]||(e[4]=[c("草稿",-1)])]),_:1})):t.status==="PUBLISHED"?(s(),u(h,{key:1,type:"success",size:"small"},{default:l(()=>[...e[5]||(e[5]=[c(" 已发布 ",-1)])]),_:1})):t.status==="ARCHIVED"?(s(),u(h,{key:2,type:"warning",size:"small"},{default:l(()=>[...e[6]||(e[6]=[c(" 已归档 ",-1)])]),_:1})):_("",!0),a("span",re,g(t.category),1),a("span",ce,"浏览 "+g(t.viewCount),1)]),t.excerpt?(s(),r("div",de,g(t.excerpt),1)):_("",!0)])]),a("div",ue,[n(m,{size:"small",onClick:w=>b(t.id)},{default:l(()=>[...e[7]||(e[7]=[c("编辑",-1)])]),_:1},8,["onClick"]),t.status==="DRAFT"?(s(),u(m,{key:0,size:"small",type:"success",onClick:w=>R(t.id)},{default:l(()=>[...e[8]||(e[8]=[c(" 发布 ",-1)])]),_:1},8,["onClick"])):_("",!0),n(m,{size:"small",type:"danger",onClick:w=>T(t.id)},{default:l(()=>[...e[9]||(e[9]=[c("删除",-1)])]),_:1},8,["onClick"])])]))),128))])),o(v).length>0?(s(),r("div",pe,[n(N,{"current-page":o(y),"onUpdate:currentPage":e[0]||(e[0]=t=>P(y)?y.value=t:null),"page-size":o(p),"onUpdate:pageSize":e[1]||(e[1]=t=>P(p)?p.value=t:null),total:o(x),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:o(B),onSizeChange:o(D)},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])])):_("",!0)]),_:1})])}}}),Ee=X(me,[["__scopeId","data-v-cbe1da4e"]]);export{Ee as default};

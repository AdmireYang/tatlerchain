import{I as P,r,c as b}from"./index-CoN5ggrH.js";import{g as B,a as F,c as q,u as x,d as C,p as M}from"./ad-Da1hrELk.js";const D=P("ad",()=>{const s=r([]),d=r(null),i=r(0),a=r(!1),n=r({status:void 0,category:void 0}),l=r(1),c=r(10),v=b(()=>s.value.length<i.value);async function u(e){a.value=!0;try{const t={page:(e==null?void 0:e.page)??l.value,pageSize:(e==null?void 0:e.pageSize)??c.value,status:(e==null?void 0:e.status)??n.value.status,category:(e==null?void 0:e.category)??n.value.category},o=await B(t);s.value=o.data.data.data,i.value=o.data.data.meta.total,l.value=o.data.data.meta.page,c.value=o.data.data.meta.pageSize}catch(t){throw console.error("获取广告列表失败:",t),t}finally{a.value=!1}}async function f(e){a.value=!0;try{const t=await F(e);return d.value=t.data.data,t.data.data}catch(t){throw console.error("获取广告详情失败:",t),t}finally{a.value=!1}}async function y(e){a.value=!0;try{const t=await q(e);return await u(),t.data.data}catch(t){throw console.error("创建广告失败:",t),t}finally{a.value=!1}}async function g(e,t){a.value=!0;try{const o=await x(e,t);return await u(),o.data.data}catch(o){throw console.error("更新广告失败:",o),o}finally{a.value=!1}}async function h(e){a.value=!0;try{await C(e),await u()}catch(t){throw console.error("删除广告失败:",t),t}finally{a.value=!1}}async function w(e){a.value=!0;try{const t=await M(e);return await u(),t.data.data}catch(t){throw console.error("发布广告失败:",t),t}finally{a.value=!1}}function A(e){n.value={...n.value,...e}}function S(){n.value={status:void 0,category:void 0},l.value=1}function z(e){l.value=e}function p(e){c.value=e,l.value=1}function I(){d.value=null}return{ads:s,currentAd:d,total:i,loading:a,filters:n,page:l,pageSize:c,hasMore:v,fetchAds:u,fetchAdById:f,create:y,update:g,remove:h,publish:w,setFilters:A,resetFilters:S,setPage:z,setPageSize:p,clearCurrentAd:I}});export{D as u};

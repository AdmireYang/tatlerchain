import{ax as $,r as n,c as x}from"./vue-vendor-CaWn4O-h.js";import{s as c}from"./index-DBOFIeWp.js";function B(a){return c.get("/backstage/posts",{params:a})}function F(a){return c.get(`/backstage/posts/${a}`)}function I(a){return c.post("/backstage/posts",a)}function q(a,l){return c.put(`/backstage/posts/${a}`,l)}function C(a){return c.delete(`/backstage/posts/${a}`)}function M(a){return c.patch(`/backstage/posts/${a}/publish`)}const D=$("post",()=>{const a=n([]),l=n(null),f=n(0),o=n(!1),s=n({search:"",status:void 0,category:void 0}),u=n(1),v=n(10),d=x(()=>a.value.length<f.value);async function i(t){o.value=!0;try{const e={page:(t==null?void 0:t.page)??u.value,pageSize:(t==null?void 0:t.pageSize)??v.value,search:(t==null?void 0:t.search)??s.value.search,status:(t==null?void 0:t.status)??s.value.status,category:(t==null?void 0:t.category)??s.value.category},r=await B(e);a.value=r.data.data.data,f.value=r.data.data.meta.total,u.value=r.data.data.meta.page,v.value=r.data.data.meta.pageSize}catch(e){throw console.error("获取推文列表失败:",e),e}finally{o.value=!1}}async function g(t){o.value=!0;try{const e=await F(t);return l.value=e.data.data,e.data.data}catch(e){throw console.error("获取推文详情失败:",e),e}finally{o.value=!1}}async function y(t){o.value=!0;try{const e=await I(t);return await i(),e.data.data}catch(e){throw console.error("创建推文失败:",e),e}finally{o.value=!1}}async function h(t,e){o.value=!0;try{const r=await q(t,e);return await i(),r.data.data}catch(r){throw console.error("更新推文失败:",r),r}finally{o.value=!1}}async function w(t){o.value=!0;try{await C(t),await i()}catch(e){throw console.error("删除推文失败:",e),e}finally{o.value=!1}}async function P(t){o.value=!0;try{const e=await M(t);return await i(),e.data.data}catch(e){throw console.error("发布推文失败:",e),e}finally{o.value=!1}}function b(t){s.value={...s.value,...t}}function p(){s.value={search:"",status:void 0,category:void 0},u.value=1}function S(t){u.value=t}function k(t){v.value=t,u.value=1}function z(){l.value=null}return{posts:a,currentPost:l,total:f,loading:o,filters:s,page:u,pageSize:v,hasMore:d,fetchPosts:i,fetchPostById:g,create:y,update:h,remove:w,publish:P,setFilters:b,resetFilters:p,setPage:S,setPageSize:k,clearCurrentPost:z}});export{B as g,D as u};
